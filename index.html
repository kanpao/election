<!DOCTYPE html>
<html lang="th">
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <title>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏†‡∏≤ ‡∏≠‡∏ö‡∏à.‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ 2570</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Kanit', sans-serif; background-color: #0f172a; color: #fff; min-height: 100vh; display: flex; flex-direction: column; }
    .bg-grid-pattern { background-image: linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px); background-size: 40px 40px; position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: -1; }

    .desktop-nav { display: none; flex-wrap: wrap; justify-content: center; gap: 8px; }

    .list-card { 
      background: rgba(30, 41, 59, 0.6); 
      backdrop-filter: blur(10px); 
      border: 1px solid rgba(255, 255, 255, 0.1); 
      transition: 0.3s; 
      position: relative; 
      overflow: visible !important; 
    }

    .winner-spacing { margin-top: 80px !important; }

    .shimmer-wrapper {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      overflow: hidden; border-radius: inherit; pointer-events: none;
    }
    .shimmer-effect::before {
      content: ''; position: absolute; top: -50%; left: -100%; width: 200%; height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.2), transparent);
      animation: shimmer 3s linear infinite;
    }

    .winner-card-gold {
      border: 2px solid #FCD34D !important;
      animation: glowPulse 2s infinite alternate;
      background: linear-gradient(135deg, rgba(45, 34, 12, 0.9) 0%, rgba(30, 41, 59, 0.8) 100%) !important;
      z-index: 10;
    }

    @keyframes glowPulse {
      0% { box-shadow: 0 0 5px rgba(252, 211, 77, 0.3); }
      100% { box-shadow: 0 0 25px rgba(252, 211, 77, 0.7); border-color: #F59E0B; }
    }
    @keyframes shimmer {
      0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
      100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }
    @keyframes bounce {
      0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-35px); } 60% { transform: translateY(-15px); }
    }
    .bounce-anim { display: inline-block; animation: bounce 2s infinite; position: relative; z-index: 50; }

    @media (min-width: 1024px) {
      .desktop-nav { display: flex; } .mobile-nav-toggle { display: none; }
    }
    .badge-rank-1 { background: linear-gradient(135deg, #FFD700, #FFA500); color: #000; box-shadow: 0 0 10px rgba(255, 215, 0, 0.5); border: 2px solid #fff; }
  </style>
</head>
<body class="pb-10">
  <div class="bg-grid-pattern"></div>
  
  <header class="sticky top-0 z-[100] bg-slate-900/95 border-b border-slate-700 backdrop-blur-md px-4 py-3">
    <div class="container mx-auto flex justify-between items-center gap-4">
      <div class="flex items-center gap-3 shrink-0">
        <img src="https://kanpao.github.io/images/kanpao-logo-160px.png" class="w-10 h-10 md:w-12 md:h-12 object-contain" alt="Logo">
        <div class="hidden sm:block">
          <h1 class="text-xs md:text-sm font-black tracking-tight leading-tight uppercase">
            ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏™‡∏†‡∏≤ ‡∏≠‡∏ö‡∏à.‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ <span class="text-yellow-500 ml-1">2570</span>
          </h1>
        </div>
      </div>
      <nav class="desktop-nav flex-1 px-4"></nav>
      <button onclick="toggleMobileMenu()" class="mobile-nav-toggle p-2 bg-slate-800 rounded-lg border border-slate-600 shrink-0">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
        </svg>
      </button>
    </div>
  </header>

  <div id="mobile-menu" class="fixed inset-0 bg-slate-900/98 z-[110] hidden flex-col p-6 overflow-y-auto">
    <div class="flex justify-between items-center mb-8">
      <h3 class="text-xl font-bold text-yellow-500 italic">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</h3>
      <button onclick="toggleMobileMenu()" class="p-2 text-white"><svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg></button>
    </div>
    <div id="mobile-nav-list" class="flex flex-col gap-3 text-center"></div>
  </div>

  <main class="container mx-auto px-4 max-w-4xl mt-10 flex-grow">
    <div class="mb-10 border-b border-slate-700 pb-4 text-center md:text-left">
      <h2 id="section-title" class="text-2xl md:text-4xl font-extrabold italic uppercase tracking-tight leading-snug">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</h2>
      <p id="update-time" class="text-[9px] text-slate-500 mt-2 uppercase tracking-widest"></p>
    </div>
    <div id="content-list" class="flex flex-col gap-8"></div>
  </main>

  <footer class="text-center py-8 text-slate-500 text-[10px] md:text-xs mt-10 border-t border-slate-800 bg-slate-900/50 backdrop-blur-sm uppercase tracking-widest">
    &copy; 2026 All Rights Reserved Powered by Mr.Wansawang Kanchanakaree
  </footer>

  <script>
    const FIREBASE_URL = 'https://kanpao-election-2026-default-rtdb.asia-southeast1.firebasedatabase.app/election-data.json';
    const menuItems = ["‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°", "‡∏ô‡∏≤‡∏¢‡∏Å ‡∏≠‡∏ö‡∏à.", "‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ", "‡∏ó‡πà‡∏≤‡∏°‡∏∞‡∏Å‡∏≤", "‡∏ó‡πà‡∏≤‡∏°‡πà‡∏ß‡∏á", "‡∏ó‡∏≠‡∏á‡∏ú‡∏≤‡∏†‡∏π‡∏°‡∏¥", "‡∏î‡πà‡∏≤‡∏ô‡∏°‡∏∞‡∏Ç‡∏≤‡∏°‡πÄ‡∏ï‡∏µ‡πâ‡∏¢", "‡∏®‡∏£‡∏µ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå", "‡∏™‡∏±‡∏á‡∏Ç‡∏•‡∏∞‡∏ö‡∏∏‡∏£‡∏µ", "‡∏´‡∏ô‡∏≠‡∏á‡∏õ‡∏£‡∏∑‡∏≠", "‡∏´‡πâ‡∏ß‡∏¢‡∏Å‡∏£‡∏∞‡πÄ‡∏à‡∏≤", "‡πÑ‡∏ó‡∏£‡πÇ‡∏¢‡∏Ñ", "‡∏ö‡πà‡∏≠‡∏û‡∏•‡∏≠‡∏¢", "‡∏û‡∏ô‡∏°‡∏ó‡∏ß‡∏ô", "‡πÄ‡∏•‡∏≤‡∏Ç‡∏ß‡∏±‡∏ç"];
    let currentTab = menuItems[0]; 
    let electionData = null;

    function toggleMobileMenu() {
      document.getElementById('mobile-menu').classList.toggle('hidden');
    }

    async function loadData() {
      try {
        const res = await fetch(FIREBASE_URL + '?t=' + Date.now());
        const data = await res.json();
        if (data) {
          electionData = data;
          render();
          document.getElementById('update-time').innerText = "Update: " + new Date(data.lastUpdate).toLocaleTimeString();
        }
      } catch(e) { console.error("Error"); }
    }

    function render() {
      if (!electionData) return;
      const { candidates, showWinnerEffects } = electionData;
      const list = document.getElementById('content-list');
      const title = document.getElementById('section-title');
      list.innerHTML = '';
      renderNavs();

      if (currentTab === "‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°") {
        title.innerHTML = '<span class="text-yellow-500">üèÜ ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</span> (‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£)';
        
        const allZones = {};
        candidates.forEach(c => {
          const key = c.district + '|' + c.zone; 
          if (!allZones[key]) allZones[key] = [];
          allZones[key].push(c);
        });

        const sortedKeys = Object.keys(allZones).sort((a, b) => {
           const distA = a.split('|')[0];
           const distB = b.split('|')[0];
           const zoneA = parseInt(a.split('|')[1]) || 0;
           const zoneB = parseInt(b.split('|')[1]) || 0;
           
           if (distA !== distB) {
             return menuItems.indexOf(distA) - menuItems.indexOf(distB);
           }
           return zoneA - zoneB;
        });

        sortedKeys.forEach(key => {
          const cList = allZones[key];
          cList.sort((a,b) => b.score - a.score);
          if(cList.length > 0) {
            const winner = cList[0];
            list.appendChild(createCard(winner, 1, winner.score, true, showWinnerEffects));
          }
        });

      } else if (currentTab === "‡∏ô‡∏≤‡∏¢‡∏Å ‡∏≠‡∏ö‡∏à.") {
        title.innerText = "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡πâ‡∏á ‡∏ô‡∏≤‡∏¢‡∏Å‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ";
        const cList = candidates.filter(c => c.district === "‡∏ô‡∏≤‡∏¢‡∏Å ‡∏≠‡∏ö‡∏à.").sort((a,b) => b.score - a.score);
        const max = cList.length > 0 ? cList[0].score : 1;
        cList.forEach((c, i) => list.appendChild(createCard(c, i+1, max, false, showWinnerEffects)));
      } else {
        title.innerText = `‡πÄ‡∏Ç‡∏ï‡∏≠‡∏≥‡πÄ‡∏†‡∏≠${currentTab}`;
        
        const distCandidates = candidates.filter(c => c.district === currentTab);
        
        const zones = {};
        distCandidates.forEach(c => {
           const z = c.zone || "‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ";
           if(!zones[z]) zones[z] = [];
           zones[z].push(c);
        });

        const sortedZones = Object.keys(zones).sort((a,b) => parseInt(a) - parseInt(b));

        sortedZones.forEach(z => {
           const zoneHeader = document.createElement('div');
           zoneHeader.className = "text-xl md:text-2xl font-bold text-yellow-500 mt-8 mb-4 border-l-4 border-yellow-500 pl-4";
           zoneHeader.innerText = `‡πÄ‡∏Ç‡∏ï ${z} ‡∏≠.${currentTab}`;
           list.appendChild(zoneHeader);

           const cList = zones[z].sort((a,b) => b.score - a.score);
           const max = cList.length > 0 ? cList[0].score : 1;

           cList.forEach((c, i) => list.appendChild(createCard(c, i+1, max, false, showWinnerEffects)));
        });

        if (distCandidates.length === 0) {
           list.innerHTML = `<div class="text-center text-slate-500 py-10 border border-dashed border-slate-700 rounded-xl">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï‡∏ô‡∏∑‡πâ</div>`;
        }
      }
    }

    function renderNavs() {
      const desktop = document.querySelector('.desktop-nav');
      const mobile = document.getElementById('mobile-nav-list');
      desktop.innerHTML = ''; mobile.innerHTML = '';

      menuItems.forEach(item => {
        const active = currentTab === item;
        let extraClass = item === "‡∏ô‡∏≤‡∏¢‡∏Å ‡∏≠‡∏ö‡∏à." ? "border-yellow-500/50 text-yellow-100" : "";
        
        const dBtn = document.createElement('button');
        dBtn.className = `px-3 py-1.5 rounded-md text-[10px] md:text-xs font-bold transition whitespace-nowrap ${active ? 'bg-yellow-500 text-black shadow-lg' : 'bg-slate-800 text-slate-400 hover:text-white border border-slate-700'} ${extraClass}`;
        dBtn.innerText = item;
        dBtn.onclick = () => { currentTab = item; render(); };
        desktop.appendChild(dBtn);

        const mBtn = document.createElement('button');
        mBtn.className = `w-full p-4 rounded-xl text-lg font-bold border ${active ? 'bg-yellow-500 text-black border-yellow-500' : 'bg-slate-800 text-white border-slate-700'}`;
        mBtn.innerText = item;
        mBtn.onclick = () => { currentTab = item; toggleMobileMenu(); render(); };
        mobile.appendChild(mBtn);
      });
    }

    function createCard(c, rank, max, isSum, winnerStatus) {
      const div = document.createElement('div');
      const pct = max > 0 ? (c.score / max) * 100 : 0;
      const isWinnerOn = (rank === 1 && winnerStatus === 'ON');
      const useFullEffect = (isWinnerOn && !isSum);

      const crown = useFullEffect ? '<div class="absolute -top-14 left-6 text-5xl bounce-anim">üëë</div>' : '';
      const trophy = useFullEffect ? '<span class="ml-2 bounce-anim text-3xl">üèÜ</span>' : (rank === 1 && !isSum ? 'üèÜ' : '');

      let districtLabel = "";
      if (isSum) {
         if (c.district === "‡∏ô‡∏≤‡∏¢‡∏Å ‡∏≠‡∏ö‡∏à.") {
            districtLabel = "‡∏ô‡∏≤‡∏¢‡∏Å ‡∏≠‡∏ö‡∏à.‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ";
         } else {
            // --- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: ‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏≠. ‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ ---
            districtLabel = `‡∏≠.${c.district} ‡πÄ‡∏Ç‡∏ï ${c.zone}`; 
         }
      }

      div.className = `list-card rounded-2xl p-6 flex items-center gap-4 ${useFullEffect ? 'winner-card-gold winner-spacing' : ''}`;
      
      div.innerHTML = `
        ${useFullEffect ? '<div class="shimmer-wrapper shimmer-effect"></div>' : ''}
        ${crown}
        <div class="relative shrink-0 z-10">
          <div class="w-20 h-20 md:w-24 md:h-24 rounded-full bg-slate-800 border-2 ${useFullEffect ? 'border-yellow-400' : 'border-slate-600'} overflow-hidden flex items-center justify-center">
            ${(c.image && c.image.toString().startsWith('http')) 
              ? `<img src="${c.image}" class="w-full h-full object-cover">` 
              : `<span class="text-4xl font-black text-slate-700">${c.name.charAt(0)}</span>`
            }
          </div>
          <div class="absolute -bottom-1 -right-1 w-9 h-9 md:w-10 md:h-10 rounded-full flex items-center justify-center font-black z-10 ${rank === 1 ? 'badge-rank-1' : 'bg-slate-700 text-slate-300 border-2 border-slate-500'} text-sm md:text-base">${c.number}</div>
        </div>
        <div class="flex-1 min-w-0 z-10 relative mt-1">
          ${isSum ? `<div class="text-xs md:text-sm text-yellow-500 font-bold uppercase mb-1 tracking-wider">${districtLabel}</div>` : ''}
          
          <div class="text-xl md:text-2xl font-black truncate flex items-center ${rank === 1 ? 'text-white' : 'text-slate-200'}">
            ${c.name} ${trophy}
          </div>
          <div class="w-full bg-slate-900/50 h-3 md:h-4 rounded-full mt-3 overflow-hidden border border-slate-700">
            <div class="h-full bg-gradient-to-r from-yellow-400 to-orange-500 transition-all duration-1000" style="width:${pct}%"></div>
          </div>
        </div>
        <div class="text-right shrink-0 z-10 pl-2">
            <div class="text-[10px] md:text-xs text-slate-500 mb-1 font-bold uppercase tracking-tighter">SCORE</div>
            <div class="text-3xl md:text-4xl font-black ${rank === 1 ? 'text-yellow-500' : 'text-white'}">${c.score.toLocaleString()}</div>
        </div>
      `;
      return div;
    }

    setInterval(loadData, 5000);
    window.onload = loadData;
  </script>
</body>
</html>
